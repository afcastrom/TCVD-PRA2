---
title: "R Notebook"
output: html_notebook
---


  ```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 1 Càrrega de l’arxiu de dades i breu descripció
  
---
title: "R Notebook"
output: html_notebook
---




## 1 Càrrega de l’arxiu de dades i breu descripció

  
```{r Read, message=FALSE, warning=FALSE, paged.print=TRUE}
#Llibreria per a crear taules resum
library(knitr)
library(kableExtra)
#Lliberia readr per llegir
library(readr)
library(plyr)
library(dplyr)
library(tidyverse)
library(lubridate)



FitxerCotxe <- read.csv(file="Datos_coches_ventas.csv", fill = TRUE, encoding="UTF-8", stringsAsFactors = F)
```

Una vegada realitzada la càrrega, volem conèixer quantes files i columnes conté el nostre fitxer:

```{r}

summary(FitxerCotxe)

str(FitxerCotxe)

cat("Files i columnes","\n")
nrow(FitxerCotxe)
ncol(FitxerCotxe)

```

# 2 Integració i selecció de les dades

Eliminem la variable 'fecha' y 'modelo'. No ens aporta informació.

```{r}
FitxerCotxe <- FitxerCotxe [,c(-1:-2)]

head(FitxerCotxe)
```

# Modificamos variable combustible a G y D
# Modificamos variable cambio a A y M

```{r}
FitxerCotxe[FitxerCotxe$Cambio == "Manual", "Cambio"] = "M"

FitxerCotxe[(str_which(FitxerCotxe$Cambio, "Autom")), "Cambio"] = "A"
FitxerCotxe[(str_which(FitxerCotxe$combustible, "Di")), "combustible"] = "D"

FitxerCotxe[FitxerCotxe$combustible == "Gasolina", "combustible"] = "G"

FitxerCotxe$Cambio <- as.factor (FitxerCotxe$Cambio)
FitxerCotxe$combustible <- as.factor(FitxerCotxe$combustible)
```


# Transformem la variable potència

```{r}

#Convertirm la variable Motor i ens quedem sols amb la part numèrcia de KW
FitxerCotxe$Potencia<-str_extract(FitxerCotxe$Potencia,"\\d+")

head(FitxerCotxe)

```


#Verifiquem valors perduts

```{r}
#Comprovem valors perduts
ValorsPerduts <- colSums(is.na(FitxerCotxe))
ValorsPerduts

#Filtrem
FiltraPerduts<-filter(FitxerCotxe,is.na(FitxerCotxe$Potencia))
FiltraPerduts

#Convertim a integer
FitxerCotxe$Potencia<-as.integer(FitxerCotxe$Potencia)


#Eliminar registres sense informar Potencia
FitxerCotxe <- na.omit(FitxerCotxe)

#Comprovem valors perduts
ValorsPerduts <- colSums(is.na(FitxerCotxe))
ValorsPerduts


```


```{r}

#Any

FitxerCotxe$Any <- make_date(year = str_extract(FitxerCotxe$Año, "....$"), month = str_extract(FitxerCotxe$Año, "^.."))

```

```{r}


#kilometres; convertimos a Kms

FitxerCotxe$Kilometraje <- as.integer (FitxerCotxe$Kilometraje*1000)
  
summary(FitxerCotxe)
```

```{r}


#modelo y version

FitxerCotxe$Version <- as.factor (FitxerCotxe$Version)

```


```{r}


#Verifiquem si hi ha  registres duplicats
#Files
nrow(FitxerCotxe)
#Files diferents
count(distinct(FitxerCotxe))

summary(FitxerCotxe)

```




```{r}

# 4.1. Agrupaci?n por tipo de combustible y tipo de cambio

FC_d <- FC[FC$Combustible == "D",] 
FC_g <- FC[FC$Combistible == "G",]

FC_a <- FC[FC$Cambio == "A",] 
FC_m <- FC[FC$Cambio == "M",]

```

```{r}

# 4.3. Son mas caros las A3s Diesel que los Gasolina...? Contraste de Hipotesis

CH_pd <- subset (FC, combustible == "D", select = "Precio")
CH_pg <- subset (FC, combustible == "G", select = "Precio") 



t.test(CH_pg, CH_pd, alternative = "less") 


```

## Contraste de hipotesis unilateral de dos muestras sobre la diferencia de medias.
## H_0 -- son iguales las medias 
## H_1 -- media precio diesel > media precio gasolina --> media precio gasolina - media precio diesel < 0


## Como obtenemos p-valor menor que alfa; rechazamos hipotesis nula y lo que es lo mismo aceptamos la alternativa H_1








